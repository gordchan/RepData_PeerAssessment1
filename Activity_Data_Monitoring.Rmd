---
title: "Activity Data Monitoring"
author: "Gordon CHAN"
date: "2015/8/5"
output: html_document
---

## Loading the dataset

The following code is used to load the dataset located in the working directory in form of CSV. Data not available are omitted from the dataset.

```{r}
  activity <- read.csv("activity.csv")
  
```

The date are read in by lubridate package.

```{r}
  library(lubridate)

  activity$date <- ymd(activity$date)
```

## Mean and median of steps taken each day

The dataset is grouped by the date, then dplyr package is used to generate a summary table showing the sum, mean and median for each day.

After omitting the NA values, a histogram is plotted showing the frequency of steps taken each day.

```{r}
library(dplyr)

activity <- group_by(activity, date)
activity_nona <- na.omit(activity)

activity_summary <- summarise(activity_nona, sum(steps), mean(steps), median(steps))

Total.Steps <- 1:nrow(activity_summary)
Freq <- activity_summary$`sum(steps)`
myhist <-list(breaks=Total.Steps, counts=Freq, xname="Total Steps per Day")
class(myhist) <- "histogram"
plot(myhist, col = "pink")

library(knitr)

kable(activity_summary)

```

## Average daily activity pattern

The mean step taken for each interval is aggregated and collected into a table. The aggregated table is then plotted.

```{r}

steps_int <- aggregate(activity_nona$steps, list(interval = activity_nona$interval), mean)
names(steps_int) [2] <- "average_steps"

plot(steps_int$interval, steps_int$average_steps, type = "l", xlab = "Time Interval", ylab = "Average Steps")
title(main = "Average steps throughout the day")

```

The interval with the maximun average steps is found by filtering the aggregated table.

```{r}
max_int <- filter(steps_int, average_steps == max(average_steps))

max_int$interval
```

From the result, the interval with the most step count is `r max_int$interval`.

## Imputing NA values

From the original dataset, a large number of NA values are present.

```{r}
length(is.na(activity$steps))
```

Since the NA values are linked to interval numbers and should not be dropped. Values are imputed from the average value of that interval.

```{r}

```

