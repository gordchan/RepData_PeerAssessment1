---
title: "Activity Data Monitoring"
author: "Gordon CHAN"
date: "2015/8/5"
output: html_document
---

## Loading the dataset

The following code is used to load the dataset located in the working directory in form of CSV. Data not available are omitted from the dataset.

```{r}
  activity <- read.csv("activity.csv")
  
```

The date are read in by lubridate package.

```{r}
  library(lubridate)

  activity$date <- ymd(activity$date)
```

## Mean and median of steps taken each day

The dataset is grouped by the date, then dplyr package is used to generate a summary table showing the sum, mean and median for each day.

After omitting the NA values, a histogram is plotted showing the frequency of steps taken each day.

```{r}
library(dplyr)

activity <- group_by(activity, date)
activity_nona <- na.omit(activity)

activity_summary <- summarise(activity_nona, sum(steps), mean(steps), median(steps))

Total.Steps <- 1:nrow(activity_summary)
Freq <- activity_summary$`sum(steps)`
myhist <-list(breaks=Total.Steps, counts=Freq, xname="Total Steps per Day")
class(myhist) <- "histogram"
plot(myhist, col = "pink")

library(knitr)

kable(activity_summary)

```

## Average daily activity pattern

The mean step taken for each interval is aggregated and collected into a table. The aggregated table is then plotted.

```{r}

steps_int <- aggregate(activity_nona$steps, list(interval = activity_nona$interval), mean)
names(steps_int) [2] <- "average_steps"

plot(steps_int$interval, steps_int$average_steps, type = "l", xlab = "Time Interval", ylab = "Average Steps")
title(main = "Average steps throughout the day")

```

The interval with the maximun average steps is found by filtering the aggregated table.

```{r}
max_int <- filter(steps_int, average_steps == max(average_steps))

max_int$interval
```

From the result, the interval with the most step count is `r max_int$interval`.

## Imputing NA values

From the original dataset, a large number of NA values are present.

```{r}
length(is.na(activity$steps))
```

Since the NA values are linked to interval numbers and should not be dropped. Values are imputed from the rounded average value of that interval.

```{r}

activity_imp <- activity

for (i in 1:nrow(activity_imp)){
  
  steps <- activity_imp[i,1]
  
  if (is.na(steps)){
    
    int <- as.numeric(activity_imp[i,3])
    
      avg <- filter(steps_int, interval==int)
    
      activity_imp[i,1] <- round(avg$average_steps)
    
    } else steps
  
}

```

The imputed dataset is grouped by the date, then dplyr package is used to generate a summary table showing the sum, mean and median for each day.

```{r}
activity_imp <- group_by(activity_imp, date)

activity_imp_summary <- summarise(activity_imp, sum(steps), mean(steps), median(steps))

Total.Steps <- 1:nrow(activity_imp_summary)
Freq <- activity_imp_summary$`sum(steps)`
myhist_i <-list(breaks=Total.Steps, counts=Freq, xname="Total Steps per Day (incl imputed NA values)")
class(myhist_i) <- "histogram"
plot(myhist_i, col = "blue")

library(knitr)

kable(activity_imp_summary)
```

To compare the estimate omitting NAs with one imputing the NAs, summaries are generated.

```{r}

summary(activity_summary)

summary(activity_imp_summary)

```

From the summaries, it is clear that imputing NA values has little impact to the mean value since the imputation was referencing the mean values. However it would affect the median since many of the imputed NAs have non-zero values.

## Activity pattern between weekdays and weekends

